version: 2.1
orbs:
  infracost:
    jobs:
      diff:
        docker:
          - image: infracost/infracost:test
        parameters:
          tfdir:
            type: string
            default: .
            description: The root directory of your terraform file
          percentage_threshold:
            type: string
            default: "0"
            description: percentage threshold
        steps:
          - checkout
          - run: /scripts/ci/diff.sh "" "" "" << parameters.tfdir >> "" << parameters.percentage_threshold >> ""

workflows:
  main:
    jobs:
      - infracost/diff:
          tfdir: aws
